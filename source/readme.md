Entire source here, all for educational purposes. It has some errors, but you can resolve them easily
